# 104.3 Control mounting and unmounting of filesystems

1. С помощью `mount` можно смонтировать файловую систему ext4 на **/dev/sdc1** в каталог **/mnt/external** как только для чтения, используя опции `noatime` и async`?
```sh
mount -t ext4 -o noatime,async,ro /dev/sdc1 /mnt/external
```
2. При размонтировании файловой системы на **/dev/sdd2** выдается сообщение об ошибке target is busy.
Как узнать, какие файлы на файловой системе открыты и какие процессы их открывали?

Используйте команду `lsof` с последующим указанием имени устройства:
```sh
lsof /dev/sdd2
```

3. Рассмотрим следующую запись в файле **/etc/fstab**: 
```console
/dev/sdb1 /data ext4 noatime,noauto,async
```
Будет ли смонтирована эта файловая система при выполнении команды `mount -a`? Почему?

Она не будет смонтирована. Ключевым является параметр `noauto`, который означает, что эта запись будет проигнорирована командой `mount -a`.

4. Как узнать UUID файловой системы на раздкле **/dev/sdb1**?

Используйте `lsblk -f`, а затем имя файловой системы:
```sh
lsblk -f /dev/sdb1
```

5. Как с помощью `mount` перемонтировать в режим "только чтение" файловую систему **exFAT** с **UUID 6e2c12e3-472d-4bac-a257-c49ac07f3761**, смонтированную по адресу **/mnt/data**?

Так как файловая система смонтирована, вам не нужно беспокоиться о типе файловой системы или ее идентификаторе, достаточно использовать опцию `remount` с параметром `ro` (только для чтения) и точкой монтирования:
```sh
mount -o remount,ro /mnt/data
```

6. Как получить список всех файловых систем ext3 и ntfs, смонтированных в данный момент в системе?

Используйте команду `mount -t`, за которой следует список файловых систем, разделенный запятыми:
```sh
mount -t ext3,ntfs
```

7. Рассмотрим следующую запись в **/etc/fstab**: 
```console
/dev/sdc1 /backup ext4 noatime,nouser,async
```
Может ли пользователь подключить эту файловую систему с помощью команды `mount /backup`? Почему?

Нет, параметр `nouser` не позволит обычным пользователям монтировать эту файловую систему.

8. Рассмотрим удаленную файловую систему, смонтированную по адресу **/mnt/server**, которая стала недоступной из-за потери сетевого соединения. Как можно принудительно размонтировать ее или смонтировать как **readonly** если это невозможно?
Передайте параметры `-f` и `-r` для размонтирования. Команда будет выглядеть так: `umount -f -r /mnt/server`. Помните, что параметры можно группировать, поэтому `umount -fr /mnt/server` также будет работать.

9. Создайте в файле **/etc/fstab** запись, которая будет монтировать том **btrfs** с меткой **Backup** на **/mnt/backup**, с параметрами по умолчанию и без возможности выполнения с него двоичных файлов.

Строка должна иметь вид 
```console
LABEL=Backup /mnt/backup btrfs defaults,noexec
```

10. Рассмотрим следующий юнит монтирования systemd:
```ini
[Unit]
Description=External data disk

[Mount]
What=/dev/disk/by-uuid/56C11DCC5D2E1334
Where=/mnt/external
Type=ntfs
Options=defaults

[Install]
WantedBy=multi-user.target
```

- Какой будет эквивалентная запись **/etc/fstab** для этой файловой системы?

Запись будет такой: 
```console
UUID=56C11DCC5D2E1334 /mnt/external ntfs defaults
```

11. Каким должно быть имя файла для вышеуказанного юнита, чтобы он мог использоваться **systemd**? Где он должен быть размещен?

Имя файла должно совпадать с именем точки монтирования, поэтому **mnt-external.mount**, размещенный в файле **/etc/systemd/system**.

