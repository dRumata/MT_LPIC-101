# 103.7 Search text files using regular expressions

1. What extended regular expression would match any email address, like info@example.org?
egrep "\S+@\S+\.\S+"
2. What extended regular expression would only match any IPv4 address in the standard dottedquad
format, like 192.168.15.1?
egrep "[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"
3. How can the grep command be used to list the contents of file /etc/services, discarding all
comments (lines starting with #)?
grep -v ^# /etc/services
4. The file domains.txt contains a list of domain names, one per line. How would the egrep
command be used to list only .org or .com domains?
egrep ".org$|.com$" domains.txt

1. From the current directory, how would the find command use an extended regular expression
to search for all files not containing a standard file suffix (file names not ending in .txt or .c,
for example)?
find . -type f -regextype egrep -not -regex '.*\.[[:alnum:]]{1,}$'
2. Command less is the default paginator for displaying long text files in the shell environment.
By typing /, a regular expression can be entered in the search prompt to jump to the first
corresponding match. In order to stay in the current document position and only highlight the
corresponding matches, what key combination should be entered at the search prompt?
Pressing Ctrl + K before entering the search expression.
3. In less, how would it be possible to filter the output so only lines which match a regular
expression get displayed?
By pressing & and entering the search expression.

1. Command last shows a listing of last logged in users, including their origin IPs. How would
the egrep command be used to filter last output, showing only occurrences of an IPv4
address, discarding any additional information in the corresponding line?
last -i | egrep -o '[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}'
2. What option should be given to grep in order to correctly filter the output generated by
command find executed with option -print0?
The option -z or --null-data, as in find . -print0 | grep -z expression.
3. Command uptime -s shows the last date when the system was powered on, as in 2019-08-05
20:13:22. What will be the result of command uptime -s | sed -e 's/(.*) (.*)/\1/'?
An error will occur. By default, parenthesis should be escaped to use backreferences in sed.
4. What option should be given to grep so it counts matching lines instead of displaying them?
Option -c.

1. The basic structure of an HTML file starts with elements html, head and body, for example:
<html>
<head>
<title>News Site</title>
</head>
<body>
<h1>Headline</h1>
<p>Information of interest.</p>
</body>
</html>
Describe how addresses could be used in sed to display only the body element and its contents.
To only show body, the addresses should be /<body>/,/<\/body>/, as in sed -n -e
'/<body>/,/<\/body>/p'. Option -n is given to sed so it doesnâ€™t print lines by default, hence
the command p at the end of sed expression to print matching lines.
2. What sed expression will remove all tags from an HTML document, keeping only the rendered
text?
The sed expression s/<[^>]*>//g will replace any content enclosed in <> by an empty string.
3. Files with extension .ovpn are very popular to configure VPN clients as they contain not only
the settings, but also the contents of keys and certificates for the client. These keys and
certificates are originally in separate files, so they need to be copied into the .ovpn file. Given
the following excerpt of a .ovpn template:
client
dev tun
remote 192.168.1.155 1194
<ca>
ca.crt
</ca>
<cert>
client.crt
</cert>
<key>
client.key
</key>
<tls-auth>
ta.key
</tls-auth>
Assuming files ca.crt, client.crt, client.key and ta.key are in the current directory,
how would the template configuration be modified by sed to replace each filename by its
content?
The command
sed -r -e 's/(^[^.]*)\.(crt|key)$/cat \1.\2/e' < client.template > client.ovpn
replaces any line terminating in .crt or .key with the content of a file whose name equals the
line. Option -r tells sed to use extended regular expressions, whilst e at the end of the
expression tells sed to replace matches with the output of command cat \1.\2. The
backreferences \1 and \2 correspond to the filename and extension found in the match.
